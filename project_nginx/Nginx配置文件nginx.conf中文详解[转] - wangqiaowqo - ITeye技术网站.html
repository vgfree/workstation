<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Nginxé…ç½®æ–‡ä»¶nginx.confä¸­æ–‡è¯¦è§£[è½¬] - wangqiaowqo - ITeyeæŠ€æœ¯ç½‘ç«™</title>
    <meta name="description" content="å‚è€ƒ http://www.ha97.com/5194.html     #å®šä¹‰Nginxè¿è¡Œçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„  user www www;    #nginxè¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°ã€‚  worker_processes 8;    #å…¨å±€é”™è¯¯æ—¥å¿—å ..." />
    <meta name="keywords" content=" Nginxé…ç½®æ–‡ä»¶nginx.confä¸­æ–‡è¯¦è§£[è½¬]" />
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
    <link rel="search" type="application/opensearchdescription+xml" href="/open_search.xml" title="ITeye" />
    <link href="/rss" rel="alternate" title="wangqiaowqo" type="application/rss+xml" />
    <link href="http://www.iteye.com/stylesheets/blog.css?1462428996" media="screen" rel="stylesheet" type="text/css" />
<link href="http://www.iteye.com/stylesheets/themes/blog/green.css?1448702469" media="screen" rel="stylesheet" type="text/css" />
    <script src="http://www.iteye.com/javascripts/application.js?1448702469" type="text/javascript"></script>    
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-535605-1']);
  _gaq.push(['_setDomainName', 'iteye.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


      <link href="http://www.iteye.com/javascripts/syntaxhighlighter/SyntaxHighlighter.css?1448702469" media="screen" rel="stylesheet" type="text/css" />
  <script src="http://www.iteye.com/javascripts/syntaxhighlighter/shCoreCommon.js?1448702469" type="text/javascript"></script>
<script src="http://www.iteye.com/javascripts/hotkey.js?1448702469" type="text/javascript"></script>
  <script src="http://www.iteye.com/javascripts/code_favorites.js?1448702469" type="text/javascript"></script>
<script src="http://www.iteye.com/javascripts/weiboshare.js?1448702469" type="text/javascript"></script>
    
  </head>
  <body>
    <div id="header">
      <div id="blog_site_nav">
  <a href="http://www.iteye.com/" class="homepage">é¦–é¡µ</a>
  <a href="http://www.iteye.com/news">èµ„è®¯</a>
  <a href="http://www.iteye.com/magazines">ç²¾å</a>
  <a href="http://www.iteye.com/forums">è®ºå›</a>
  <a href="http://www.iteye.com/ask">é—®ç­”</a>
  <a href="http://www.iteye.com/blogs">åšå®¢</a>
  <a href="http://www.iteye.com/blogs/subjects">ä¸“æ </a>
  <a href="http://www.iteye.com/groups">ç¾¤ç»„</a>
  <a href="#" onclick="return false;" id="msna"><u>æ›´å¤š</u> <small>â–¼</small></a>
  <div class="quick_menu" style="display:none;">
    <a target="_blank" href="http://job.iteye.com/iteye">çŸ¥è¯†åº“</a>
    <a href="http://www.iteye.com/search">æœç´¢</a>
  </div>
</div>

      <div id="user_nav">
      <a href="/login" class="welcome" title="ç™»å½•">æ‚¨è¿˜æœªç™»å½• !</a>
    <a href="/login">ç™»å½•</a>
    <a href="/signup" class="nobg">æ³¨å†Œ</a>
  </div>

    </div>

    <div id="page">
      <div id="branding" class="clearfix">
        <div id="blog_name">
          <h1><a href="/">wangqiaowqo</a></h1>
        </div>
        <div id='fd'></div>
        <div id="blog_navbar">
          <ul>
            <li class='blog_navbar_for'><a href="http://wangqiaowqo.iteye.com"><strong>åšå®¢</strong></a></li>
            <li ><a href="/weibo">å¾®åš</a></li>
            <li ><a href="/album">ç›¸å†Œ</a></li>
            <li ><a href="/link">æ”¶è—</a></li>
            <li ><a href="/blog/guest_book">ç•™è¨€</a></li>
            <li ><a href="/blog/profile">å…³äºæˆ‘</a></li>
          </ul>
    
          <div class="search">
            <form action="/blog/search" method="get">
              <input class="search_text" id="query" name="query" style="margin-left: 10px;width: 110px;" type="text" value="" />
              <input class="submit_search" type="submit" value="" />
            </form>
          </div> 
          <div id="fd"></div>         
        </div>
      </div>
      
      <div id="content" class="clearfix">
        <div id="main">
          



          


<div class="h-entry" style='display:none'>
  <a href="http://wangqiaowqo.iteye.com" class="p-author" target="_blank">wangqiaowqo</a>
</div>


<div class="blog_main">
  <div class="blog_title">
    <h3>
      <a href="/blog/2261773">Nginxé…ç½®æ–‡ä»¶nginx.confä¸­æ–‡è¯¦è§£[è½¬]</a>
      <em class="actions">      </em>
    </h3>
    <ul class='blog_categories'><strong>åšå®¢åˆ†ç±»ï¼š</strong> <li><a href="/category/234864">nginx</a></li> </ul>
        <div class='news_tag'>&nbsp;</div>
    	  
    	
    	
  		
      </div>

  <div id="blog_content" class="blog_content">
    å‚è€ƒ<br />http://www.ha97.com/5194.html<br /><br /><pre name="code" class="java">

#å®šä¹‰Nginxè¿è¡Œçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„
user www www;

#nginxè¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°ã€‚
worker_processes 8;

#å…¨å±€é”™è¯¯æ—¥å¿—å®šä¹‰ç±»å‹ï¼Œ[ debug | info | notice | warn | error | crit ]
error_log /var/log/nginx/error.log info;

#è¿›ç¨‹æ–‡ä»¶
pid /var/run/nginx.pid;

#ä¸€ä¸ªnginxè¿›ç¨‹æ‰“å¼€çš„æœ€å¤šæ–‡ä»¶æè¿°ç¬¦æ•°ç›®ï¼Œç†è®ºå€¼åº”è¯¥æ˜¯æœ€å¤šæ‰“å¼€æ–‡ä»¶æ•°ï¼ˆç³»ç»Ÿçš„å€¼ulimit -nï¼‰ä¸nginxè¿›ç¨‹æ•°ç›¸é™¤ï¼Œä½†æ˜¯nginxåˆ†é…è¯·æ±‚å¹¶ä¸å‡åŒ€ï¼Œæ‰€ä»¥å»ºè®®ä¸ulimit -nçš„å€¼ä¿æŒä¸€è‡´ã€‚
worker_rlimit_nofile 65535;

#å·¥ä½œæ¨¡å¼ä¸è¿æ¥æ•°ä¸Šé™
events
{
#å‚è€ƒäº‹ä»¶æ¨¡å‹ï¼Œuse [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epollæ¨¡å‹æ˜¯Linux 2.6ä»¥ä¸Šç‰ˆæœ¬å†…æ ¸ä¸­çš„é«˜æ€§èƒ½ç½‘ç»œI/Oæ¨¡å‹ï¼Œå¦‚æœè·‘åœ¨FreeBSDä¸Šé¢ï¼Œå°±ç”¨kqueueæ¨¡å‹ã€‚
use epoll;
#å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•°ï¼ˆæœ€å¤§è¿æ¥æ•°=è¿æ¥æ•°*è¿›ç¨‹æ•°ï¼‰
worker_connections 65535;
}

#è®¾å®šhttpæœåŠ¡å™¨
http
{
include mime.types; #æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨
default_type application/octet-stream; #é»˜è®¤æ–‡ä»¶ç±»å‹
#charset utf-8; #é»˜è®¤ç¼–ç 
server_names_hash_bucket_size 128; #æœåŠ¡å™¨åå­—çš„hashè¡¨å¤§å°
client_header_buffer_size 32k; #ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶
large_client_header_buffers 4 64k; #è®¾å®šè¯·æ±‚ç¼“
client_max_body_size 8m; #è®¾å®šè¯·æ±‚ç¼“
sendfile on; #å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼ŒsendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ã€‚æ³¨æ„ï¼šå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹æˆoffã€‚
autoindex on; #å¼€å¯ç›®å½•åˆ—è¡¨è®¿é—®ï¼Œåˆé€‚ä¸‹è½½æœåŠ¡å™¨ï¼Œé»˜è®¤å…³é—­ã€‚
tcp_nopush on; #é˜²æ­¢ç½‘ç»œé˜»å¡
tcp_nodelay on; #é˜²æ­¢ç½‘ç»œé˜»å¡
keepalive_timeout 120; #é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’

#FastCGIç›¸å…³å‚æ•°æ˜¯ä¸ºäº†æ”¹å–„ç½‘ç«™çš„æ€§èƒ½ï¼šå‡å°‘èµ„æºå ç”¨ï¼Œæé«˜è®¿é—®é€Ÿåº¦ã€‚ä¸‹é¢å‚æ•°çœ‹å­—é¢æ„æ€éƒ½èƒ½ç†è§£ã€‚
fastcgi_connect_timeout 300;
fastcgi_send_timeout 300;
fastcgi_read_timeout 300;
fastcgi_buffer_size 64k;
fastcgi_buffers 4 64k;
fastcgi_busy_buffers_size 128k;
fastcgi_temp_file_write_size 128k;

#gzipæ¨¡å—è®¾ç½®
gzip on; #å¼€å¯gzipå‹ç¼©è¾“å‡º
gzip_min_length 1k; #æœ€å°å‹ç¼©æ–‡ä»¶å¤§å°
gzip_buffers 4 16k; #å‹ç¼©ç¼“å†²åŒº
gzip_http_version 1.0; #å‹ç¼©ç‰ˆæœ¬ï¼ˆé»˜è®¤1.1ï¼Œå‰ç«¯å¦‚æœæ˜¯squid2.5è¯·ä½¿ç”¨1.0ï¼‰
gzip_comp_level 2; #å‹ç¼©ç­‰çº§
gzip_types text/plain application/x-javascript text/css application/xml;
#å‹ç¼©ç±»å‹ï¼Œé»˜è®¤å°±å·²ç»åŒ…å«text/htmlï¼Œæ‰€ä»¥ä¸‹é¢å°±ä¸ç”¨å†å†™äº†ï¼Œå†™ä¸Šå»ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªwarnã€‚
gzip_vary on;
#limit_zone crawler $binary_remote_addr 10m; #å¼€å¯é™åˆ¶IPè¿æ¥æ•°çš„æ—¶å€™éœ€è¦ä½¿ç”¨

upstream blog.ha97.com {
#upstreamçš„è´Ÿè½½å‡è¡¡ï¼Œweightæ˜¯æƒé‡ï¼Œå¯ä»¥æ ¹æ®æœºå™¨é…ç½®å®šä¹‰æƒé‡ã€‚weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§ã€‚
server 192.168.80.121:80 weight=3;
server 192.168.80.122:80 weight=2;
server 192.168.80.123:80 weight=3;
}

#è™šæ‹Ÿä¸»æœºçš„é…ç½®
server
{
#ç›‘å¬ç«¯å£
listen 80;
#åŸŸåå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€
server_name www.ha97.com ha97.com;
index index.html index.htm index.php;
root /data/www/ha97;
location ~ .*\.(php|php5)?$
{
fastcgi_pass 127.0.0.1:9000;
fastcgi_index index.php;
include fastcgi.conf;
}
#å›¾ç‰‡ç¼“å­˜æ—¶é—´è®¾ç½®
location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
{
expires 10d;
}
#JSå’ŒCSSç¼“å­˜æ—¶é—´è®¾ç½®
location ~ .*\.(js|css)?$
{
expires 1h;
}
#æ—¥å¿—æ ¼å¼è®¾å®š
log_format access '$remote_addr - $remote_user [$time_local] "$request" '
'$status $body_bytes_sent "$http_referer" '
'"$http_user_agent" $http_x_forwarded_for';
#å®šä¹‰æœ¬è™šæ‹Ÿä¸»æœºçš„è®¿é—®æ—¥å¿—
access_log /var/log/nginx/ha97access.log access;

#å¯¹ "/" å¯ç”¨åå‘ä»£ç†
location / {
proxy_pass http://127.0.0.1:88;
proxy_redirect off;
proxy_set_header X-Real-IP $remote_addr;
#åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®ï¼Œå¯é€‰ã€‚
proxy_set_header Host $host;
client_max_body_size 10m; #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°
client_body_buffer_size 128k; #ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œ
proxy_connect_timeout 90; #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)
proxy_send_timeout 90; #åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)
proxy_read_timeout 90; #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)
proxy_buffer_size 4k; #è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°
proxy_buffers 4 32k; #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è®¾ç½®
proxy_busy_buffers_size 64k; #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰
proxy_temp_file_write_size 64k;
#è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼ 
}

#è®¾å®šæŸ¥çœ‹NginxçŠ¶æ€çš„åœ°å€
location /NginxStatus {
stub_status on;
access_log on;
auth_basic "NginxStatus";
auth_basic_user_file conf/htpasswd;
#htpasswdæ–‡ä»¶çš„å†…å®¹å¯ä»¥ç”¨apacheæä¾›çš„htpasswdå·¥å…·æ¥äº§ç”Ÿã€‚
}

#æœ¬åœ°åŠ¨é™åˆ†ç¦»åå‘ä»£ç†é…ç½®
#æ‰€æœ‰jspçš„é¡µé¢å‡äº¤ç”±tomcatæˆ–resinå¤„ç†
location ~ .(jsp|jspx|do)?$ {
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_pass http://127.0.0.1:8080;
}
#æ‰€æœ‰é™æ€æ–‡ä»¶ç”±nginxç›´æ¥è¯»å–ä¸ç»è¿‡tomcatæˆ–resin
location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$
{ expires 15d; }
location ~ .*.(js|css)?$
{ expires 1h; }
}
}

</pre><br /><br />---------------------------------------------<br />Nginx<br />https://moonbingbing.gitbooks.io/openresty-best-practices/content/ngx/nginx_brief.html<br /><br />worker_process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # è¡¨ç¤ºå·¥ä½œè¿›ç¨‹çš„æ•°é‡ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºcpuçš„æ ¸æ•°<br /><br />worker_connections&nbsp; # è¡¨ç¤ºæ¯ä¸ªå·¥ä½œè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°<br /><br />server{}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # å—å®šä¹‰äº†è™šæ‹Ÿä¸»æœº<br /><br />&nbsp;&nbsp;&nbsp; listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # ç›‘å¬ç«¯å£<br /><br />&nbsp;&nbsp;&nbsp; server_name&nbsp;&nbsp;&nbsp;&nbsp; # ç›‘å¬åŸŸå<br /><br />&nbsp;&nbsp;&nbsp; location {}&nbsp;&nbsp;&nbsp;&nbsp; # æ˜¯ç”¨æ¥ä¸ºåŒ¹é…çš„ URI è¿›è¡Œé…ç½®ï¼ŒURI å³è¯­æ³•ä¸­çš„â€œ/uri/â€<br /><br />&nbsp;&nbsp;&nbsp; location /{}&nbsp;&nbsp;&nbsp; # åŒ¹é…ä»»ä½•æŸ¥è¯¢ï¼Œå› ä¸ºæ‰€æœ‰è¯·æ±‚éƒ½ä»¥ / å¼€å¤´<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # æŒ‡å®šå¯¹åº”uriçš„èµ„æºæŸ¥æ‰¾è·¯å¾„ï¼Œè¿™é‡Œhtmlä¸ºç›¸å¯¹è·¯å¾„ï¼Œå®Œæ•´è·¯å¾„ä¸º<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # /opt/nginx-1.7.7/html/<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # æŒ‡å®šé¦–é¡µindexæ–‡ä»¶çš„åç§°ï¼Œå¯ä»¥é…ç½®å¤šä¸ªï¼Œä»¥ç©ºæ ¼åˆ†å¼€ã€‚å¦‚æœ‰å¤š<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # ä¸ªï¼ŒæŒ‰é…ç½®é¡ºåºæŸ¥æ‰¾ã€‚<br /><br />location åŒ¹é…è§„åˆ™<br />è¯­æ³•è§„åˆ™<br /><br />location [=|~|~*|^~] /uri/ { â€¦ }<br /><br />ç¬¦å·	å«ä¹‰<br />=	å¼€å¤´è¡¨ç¤ºç²¾ç¡®åŒ¹é…<br />^~	å¼€å¤´è¡¨ç¤ºuriä»¥æŸä¸ªå¸¸è§„å­—ç¬¦ä¸²å¼€å¤´ï¼Œç†è§£ä¸ºåŒ¹é… urlè·¯å¾„å³å¯ã€‚nginxä¸å¯¹urlåšç¼–ç ï¼Œå› æ­¤è¯·æ±‚ä¸º/static/20%/aaï¼Œå¯ä»¥è¢«è§„åˆ™^~ /static/ /aaåŒ¹é…åˆ°ï¼ˆæ³¨æ„æ˜¯ç©ºæ ¼ï¼‰<br />~	å¼€å¤´è¡¨ç¤ºåŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…<br />~*	å¼€å¤´è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…<br />!~å’Œ!~*	åˆ†åˆ«ä¸ºåŒºåˆ†å¤§å°å†™ä¸åŒ¹é…åŠä¸åŒºåˆ†å¤§å°å†™ä¸åŒ¹é… çš„æ­£åˆ™<br />/	é€šç”¨åŒ¹é…ï¼Œä»»ä½•è¯·æ±‚éƒ½ä¼šåŒ¹é…åˆ°ã€‚<br /><pre name="code" class="java">
location = / {
   #è§„åˆ™A  è®¿é—®æ ¹ç›®å½•/ï¼Œ æ¯”å¦‚http://localhost/ å°†åŒ¹é…è§„åˆ™A
}
location = /login {
   #è§„åˆ™B  http://localhost/login å°†åŒ¹é…è§„åˆ™B
}
location ^~ /static/ {
   #è§„åˆ™C  http://localhost/static/a.html å°†åŒ¹é…è§„åˆ™C      http://localhost/static/c.png åˆ™ä¼˜å…ˆåŒ¹é…åˆ°è§„åˆ™C
}
location ~ \.(gif|jpg|png|js|css)$ {
   #è§„åˆ™D  http://localhost/a.gif, http://localhost/b.jpg å°†åŒ¹é…è§„åˆ™Då’Œè§„åˆ™Eï¼Œä½†æ˜¯è§„åˆ™Dé¡ºåºä¼˜å…ˆï¼Œè§„åˆ™Eä¸èµ·ä½œç”¨
} 
location ~* \.png$ {
   #è§„åˆ™E   http://localhost/a.PNG åˆ™åŒ¹é…è§„åˆ™E,å› ä¸ºè§„åˆ™Eä¸åŒºåˆ†å¤§å°å†™
}
location !~ \.xhtml$ {
   #è§„åˆ™F
}
location !~* \.xhtml$ {
   #è§„åˆ™G
}
location / {
   #è§„åˆ™H  http://localhost/register åˆ™åŒ¹é…è§„åˆ™H
            http://localhost/category/id/1111 åˆ™æœ€ç»ˆåŒ¹é…åˆ°è§„åˆ™Hï¼Œå› ä¸ºä»¥ä¸Šè§„åˆ™éƒ½ä¸åŒ¹é…
}
</pre><br /><br /><br />ReWriteè¯­æ³•<br /><br />last â€“ åŸºæœ¬ä¸Šéƒ½ç”¨è¿™ä¸ªFlag<br />break â€“ ä¸­æ­¢Rewirteï¼Œä¸åœ¨ç»§ç»­åŒ¹é…<br />redirect â€“ è¿”å›ä¸´æ—¶é‡å®šå‘çš„HTTPçŠ¶æ€302<br />permanent â€“ è¿”å›æ°¸ä¹…é‡å®šå‘çš„HTTPçŠ¶æ€301<br /><br />1ã€ä¸‹é¢æ˜¯å¯ä»¥ç”¨æ¥åˆ¤æ–­çš„è¡¨è¾¾å¼ï¼š<br />-få’Œ!-fç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶<br />-då’Œ!-dç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›®å½•<br />-eå’Œ!-eç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶æˆ–ç›®å½•<br />-xå’Œ!-xç”¨æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œ<br /><br />2ã€ä¸‹é¢æ˜¯å¯ä»¥ç”¨ä½œåˆ¤æ–­çš„å…¨å±€å˜é‡<br /><pre name="code" class="java">
ä¾‹ï¼šhttp://localhost:88/test1/test2/test.php
$hostï¼šlocalhost
$server_portï¼š88
$request_uriï¼šhttp://localhost:88/test1/test2/test.php
$document_uriï¼š/test1/test2/test.php
$document_rootï¼šD:\nginx/html
$request_filenameï¼šD:\nginx/html/test1/test2/test.php
</pre><br /><br /><pre name="code" class="java">
server {
    listen 80;
    server_name start.igrow.cn;
    index index.html index.php;
    root html;
    if ($http_host !~ â€œ^star\.igrow\.cn$&amp;quot {
        rewrite ^(.*) http://star.igrow.cn$1 redirect;
    }
}
</pre><br /><br /><br />3.5 æ—¥å¿—æœåŠ¡<br />Nginxæ—¥å¿—ä¸»è¦æœ‰ä¸¤ç§ï¼šaccess_log(è®¿é—®æ—¥å¿—)ã€error_log(é”™è¯¯æ—¥å¿—)ã€‚<br /><br />access_logä¸»è¦è®°å½•å®¢æˆ·ç«¯è®¿é—®Nginxçš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œæ ¼å¼å¯ä»¥è‡ªå®šä¹‰ã€‚é€šè¿‡access_logï¼Œä½ å¯ä»¥å¾—åˆ°ç”¨æˆ·åœ°åŸŸæ¥æºã€è·³è½¬æ¥æºã€ä½¿ç”¨ç»ˆç«¯ã€æŸä¸ªURLè®¿é—®é‡ç­‰ç›¸å…³ä¿¡æ¯ã€‚+<br /><br />log_formatæŒ‡ä»¤ç”¨äºå®šä¹‰æ—¥å¿—çš„æ ¼å¼ï¼Œè¯­æ³•: log_format name string; å…¶ä¸­nameè¡¨ç¤ºæ ¼å¼åç§°ï¼Œstringè¡¨ç¤ºå®šä¹‰çš„æ ¼å¼å­—ç¬¦ä¸²ã€‚log_formatæœ‰ä¸€ä¸ªé»˜è®¤çš„æ— éœ€è®¾ç½®çš„combinedæ—¥å¿—æ ¼å¼ã€‚<br /><br /><pre name="code" class="java">
log_format combined '$remote_addr - $remote_user  [$time_local]  '
                    ' "$request"  $status  $body_bytes_sent  '
                    ' "$http_referer"  "$http_user_agent" ';
</pre><br /><br />access_logæŒ‡ä»¤ç”¨æ¥æŒ‡å®šè®¿é—®æ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼ˆåŒ…å«æ—¥å¿—æ–‡ä»¶åï¼‰ã€æ ¼å¼å’Œç¼“å­˜å¤§å°ï¼Œè¯­æ³•ï¼šaccess_log path [format_name [buffer=size | off]]; å…¶ä¸­pathè¡¨ç¤ºè®¿é—®æ—¥å¿—å­˜æ”¾è·¯å¾„ï¼Œformat_nameè¡¨ç¤ºè®¿é—®æ—¥å¿—æ ¼å¼åç§°ï¼Œbufferè¡¨ç¤ºç¼“å­˜å¤§å°ï¼Œoffè¡¨ç¤ºå…³é—­è®¿é—®æ—¥å¿—ã€‚<br /><br />éœ€è¦æ³¨æ„çš„æ˜¯ï¼šlog_formaté…ç½®å¿…é¡»æ”¾åœ¨httpå†…ï¼Œå¦åˆ™ä¼šå‡ºç°è­¦å‘Šã€‚Nginxè¿›ç¨‹è®¾ç½®çš„ç”¨æˆ·å’Œç»„å¿…é¡»å¯¹æ—¥å¿—è·¯å¾„æœ‰åˆ›å»ºæ–‡ä»¶çš„æƒé™ï¼Œå¦åˆ™ï¼Œä¼šæŠ¥é”™ã€‚<br /><br />å®šä¹‰æ—¥å¿—ä½¿ç”¨çš„å­—æ®µåŠå…¶ä½œç”¨ï¼š<br /><pre name="code" class="java">
å­—æ®µ	ä½œç”¨
$remote_addrä¸$http_x_forwarded_for	è®°å½•å®¢æˆ·ç«¯IPåœ°å€
$remote_user	è®°å½•å®¢æˆ·ç«¯ç”¨æˆ·åç§°
$request	è®°å½•è¯·æ±‚çš„URIå’ŒHTTPåè®®
$status	è®°å½•è¯·æ±‚çŠ¶æ€
$body_bytes_sent	å‘é€ç»™å®¢æˆ·ç«¯çš„å­—èŠ‚æ•°ï¼Œä¸åŒ…æ‹¬å“åº”å¤´çš„å¤§å°
$bytes_sent	å‘é€ç»™å®¢æˆ·ç«¯çš„æ€»å­—èŠ‚æ•°
$connection	è¿æ¥çš„åºåˆ—å·
$connection_requests	å½“å‰é€šè¿‡ä¸€ä¸ªè¿æ¥è·å¾—çš„è¯·æ±‚æ•°é‡
$msec	æ—¥å¿—å†™å…¥æ—¶é—´ã€‚å•ä½ä¸ºç§’ï¼Œç²¾åº¦æ˜¯æ¯«ç§’
$pipe	å¦‚æœè¯·æ±‚æ˜¯é€šè¿‡HTTPæµæ°´çº¿(pipelined)å‘é€ï¼Œpipeå€¼ä¸ºâ€œpâ€ï¼Œå¦åˆ™ä¸ºâ€œ.â€
$http_referer	è®°å½•ä»å“ªä¸ªé¡µé¢é“¾æ¥è®¿é—®è¿‡æ¥çš„
$http_user_agent	è®°å½•å®¢æˆ·ç«¯æµè§ˆå™¨ç›¸å…³ä¿¡æ¯
$request_length	è¯·æ±‚çš„é•¿åº¦ï¼ˆåŒ…æ‹¬è¯·æ±‚è¡Œï¼Œè¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡ï¼‰
$request_time	è¯·æ±‚å¤„ç†æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œç²¾åº¦æ¯«ç§’
$time_iso8601	ISO8601æ ‡å‡†æ ¼å¼ä¸‹çš„æœ¬åœ°æ—¶é—´
$time_local	è®°å½•è®¿é—®æ—¶é—´ä¸æ—¶åŒº
</pre><br /><br />error_log(é”™è¯¯æ—¥å¿—)<br />error_logä¸»è¦è®°å½•å®¢æˆ·ç«¯è®¿é—®Nginxå‡ºé”™æ—¶çš„æ—¥å¿—ï¼Œæ ¼å¼ä¸æ”¯æŒè‡ªå®šä¹‰ã€‚<br /><br />3.6 åå‘ä»£ç†<br />åå‘ä»£ç†ï¼ˆReverse Proxy ï¼‰æ–¹å¼æ˜¯æŒ‡ç”¨ä»£ç†æœåŠ¡å™¨æ¥æ¥å—internetä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™internetä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚<br /><br />å®¢æˆ·ç«¯å‘åå‘ä»£ç†çš„å‘½åç©ºé—´(name-space)ä¸­çš„å†…å®¹å‘é€æ™®é€šè¯·æ±‚ï¼Œæ¥ç€åå‘ä»£ç†å°†åˆ¤æ–­å‘ä½•å¤„(åŸå§‹æœåŠ¡å™¨)è½¬äº¤è¯·æ±‚ï¼Œå¹¶å°†è·å¾—çš„å†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå°±åƒè¿™äº›å†…å®¹åŸæœ¬å°±æ˜¯å®ƒè‡ªå·±çš„ä¸€æ ·ã€‚<br /><br />åŠ å¼ºå®‰å…¨é˜²æŠ¤ã€‚åå‘ä»£ç†è¿˜å¯ä»¥ä¸ºåç«¯çš„å¤šå°æœåŠ¡å™¨æä¾›è´Ÿè½½å‡è¡¡ï¼Œæˆ–ä¸ºåç«¯è¾ƒæ…¢çš„æœåŠ¡å™¨æä¾›ç¼“å†²æœåŠ¡ã€‚<br />åå‘ä»£ç†è¿˜å¯ä»¥å¯ç”¨é«˜çº§URLç­–ç•¥å’Œç®¡ç†æŠ€æœ¯ï¼Œä»è€Œä½¿å¤„äºä¸åŒwebæœåŠ¡å™¨ç³»ç»Ÿçš„webé¡µé¢åŒæ—¶å­˜åœ¨äºåŒä¸€ä¸ªURLç©ºé—´ä¸‹ã€‚<br />Nginxçš„å…¶ä¸­ä¸€ä¸ªç”¨é€”æ˜¯åšHTTPåå‘ä»£ç†ï¼Œä¸‹é¢ç®€å•ä»‹ç»Nginxä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨çš„æ–¹æ³•ã€‚<br /><br /><pre name="code" class="java">
worker_processes 1;

pid logs/nginx.pid;
error_log logs/error.log warn;

events {
    worker_connections 3000;
}

http {
    include mime.types;
    server_tokens off;

    ##ä¸‹é¢é…ç½®åå‘ä»£ç†çš„å‚æ•°
    server {
        listen 8866;

        ##1.ç”¨æˆ·è®¿é—®http://ip:portï¼Œåˆ™åå‘ä»£ç†åˆ°https://github.com
        location / {
            proxy_pass  https://github.com;
            proxy_redirect     off;
            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
        }

        ##2.ç”¨æˆ·è®¿é—®http://ip:port/README.mdï¼Œåˆ™åå‘ä»£ç†åˆ°https://github.com/.../README.md
        location /README.md {
            proxy_pass https://github.com/moonbingbing/openresty-best-practices/blob/master/README.md;
            proxy_set_header  X-Real-IP  $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
}
</pre><br /><br />proxy_passåé¢è·Ÿç€ä¸€ä¸ªURLï¼Œç”¨æ¥å°†è¯·æ±‚åå‘ä»£ç†åˆ°URLå‚æ•°æŒ‡å®šçš„æœåŠ¡å™¨ä¸Šã€‚ä¾‹å¦‚æˆ‘ä»¬ä¸Šé¢ä¾‹å­ä¸­çš„proxy_pass https://github.comï¼Œåˆ™å°†åŒ¹é…çš„è¯·æ±‚åå‘ä»£ç†åˆ°https://github.comã€‚<br /><br />proxy_set_header<br />é»˜è®¤æƒ…å†µä¸‹ï¼Œåå‘ä»£ç†ä¸ä¼šè½¬å‘åŸå§‹è¯·æ±‚ä¸­çš„Hostå¤´éƒ¨ï¼Œå¦‚æœéœ€è¦è½¬å‘ï¼Œå°±éœ€è¦åŠ ä¸Šè¿™å¥ï¼šproxy_set_header Host $host;<br /><br />3.7 è´Ÿè½½å‡è¡¡<br /><br />upstream è´Ÿè½½å‡è¡¡æ¨¡å—è¯´æ˜<br /><pre name="code" class="java">
upstream test.net{
    ip_hash;
    server 192.168.10.13:80;
    server 192.168.10.14:80  down;
    server 192.168.10.15:8009  max_fails=3  fail_timeout=20s;
    server 192.168.10.16:8080;
}
server {
  location / {
    proxy_pass  http://test.net;
  }
}
</pre><br /><br />upstream æ˜¯ Nginx çš„ HTTP Upstream æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—é€šè¿‡ä¸€ä¸ªç®€å•çš„è°ƒåº¦ç®—æ³•æ¥å®ç°å®¢æˆ·ç«¯ IP åˆ°åç«¯æœåŠ¡å™¨çš„è´Ÿè½½å‡è¡¡ã€‚åœ¨ä¸Šé¢çš„è®¾å®šä¸­ï¼Œé€šè¿‡ upstream æŒ‡ä»¤æŒ‡å®šäº†ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨çš„åç§° test.netã€‚<br /><br />upstream æ”¯æŒçš„è´Ÿè½½å‡è¡¡ç®—æ³•<br /><br />è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ã€‚æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æŸå°æœåŠ¡å™¨å®•æœºï¼Œæ•…éšœç³»ç»Ÿè¢«è‡ªåŠ¨å‰”é™¤ï¼Œä½¿ç”¨æˆ·è®¿é—®ä¸å—å½±å“ã€‚Weight æŒ‡å®šè½®è¯¢æƒå€¼ï¼ŒWeightå€¼è¶Šå¤§ï¼Œåˆ†é…åˆ°çš„è®¿é—®æœºç‡è¶Šé«˜ï¼Œä¸»è¦ç”¨äºåç«¯æ¯ä¸ªæœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µä¸‹ã€‚<br />ip_hashã€‚æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®IPçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¥è‡ªåŒä¸€ä¸ªIPçš„è®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œæœ‰æ•ˆè§£å†³äº†åŠ¨æ€ç½‘é¡µå­˜åœ¨çš„sessionå…±äº«é—®é¢˜ã€‚<br />fairã€‚è¿™æ˜¯æ¯”ä¸Šé¢ä¸¤ä¸ªæ›´åŠ æ™ºèƒ½çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚æ­¤ç§ç®—æ³•å¯ä»¥ä¾æ®é¡µé¢å¤§å°å’ŒåŠ è½½æ—¶é—´é•¿çŸ­æ™ºèƒ½åœ°è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚Nginxæœ¬èº«æ˜¯ä¸æ”¯æŒfairçš„ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¿™ç§è°ƒåº¦ç®—æ³•ï¼Œå¿…é¡»ä¸‹è½½Nginxçš„upstream_fairæ¨¡å—ã€‚<br />url_hashã€‚æ­¤æ–¹æ³•æŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜åç«¯ç¼“å­˜æœåŠ¡å™¨çš„æ•ˆç‡ã€‚Nginxæœ¬èº«æ˜¯ä¸æ”¯æŒurl_hashçš„ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨è¿™ç§è°ƒåº¦ç®—æ³•ï¼Œå¿…é¡»å®‰è£…Nginx çš„hashè½¯ä»¶åŒ…ã€‚<br />least_connã€‚æœ€å°‘è¿æ¥è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ¯æ¬¡é€‰æ‹©çš„åç«¯éƒ½æ˜¯å½“å‰æœ€å°‘è¿æ¥çš„ä¸€ä¸ªserver(è¿™ä¸ªæœ€å°‘è¿æ¥ä¸æ˜¯å…±äº«çš„ï¼Œæ˜¯æ¯ä¸ªworkeréƒ½æœ‰è‡ªå·±çš„ä¸€ä¸ªæ•°ç»„è¿›è¡Œè®°å½•åç«¯serverçš„è¿æ¥æ•°)ã€‚ *hashã€‚è¿™ä¸ªhashæ¨¡å—åˆæ”¯æŒä¸¤ç§æ¨¡å¼hash, ä¸€ç§æ˜¯æ™®é€šçš„hash, å¦ä¸€ç§æ˜¯ä¸€è‡´æ€§hash(consistent)ã€‚<br /><br />upstream æ”¯æŒçš„çŠ¶æ€å‚æ•°<br />downï¼Œè¡¨ç¤ºå½“å‰çš„serveræš‚æ—¶ä¸å‚ä¸è´Ÿè½½å‡è¡¡ã€‚<br />backupï¼Œé¢„ç•™çš„å¤‡ä»½æœºå™¨ã€‚å½“å…¶ä»–æ‰€æœ‰çš„ébackupæœºå™¨å‡ºç°æ•…éšœæˆ–è€…å¿™çš„æ—¶å€™ï¼Œæ‰ä¼šè¯·æ±‚backupæœºå™¨ï¼Œå› æ­¤è¿™å°æœºå™¨çš„å‹åŠ›æœ€è½»ã€‚<br />max_failsï¼Œå…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1ã€‚å½“è¶…è¿‡æœ€å¤§æ¬¡æ•°æ—¶ï¼Œè¿”å›proxy_next_upstream æ¨¡å—å®šä¹‰çš„é”™è¯¯ã€‚<br />fail_timeoutï¼Œåœ¨ç»å†äº†max_failsæ¬¡å¤±è´¥åï¼Œæš‚åœæœåŠ¡çš„æ—¶é—´ã€‚max_failså¯ä»¥å’Œfail_timeoutä¸€èµ·ä½¿ç”¨ã€‚<br />å½“è´Ÿè½½è°ƒåº¦ç®—æ³•ä¸ºip_hashæ—¶ï¼Œåç«¯æœåŠ¡å™¨åœ¨è´Ÿè½½å‡è¡¡è°ƒåº¦ä¸­çš„çŠ¶æ€ä¸èƒ½æ˜¯backupã€‚<br /><br /><pre name="code" class="java">
upstream webservers {
      server 192.168.18.201 weight=1;
      server 192.168.18.202 weight=1;
  }
  server {
      listen       80;
      server_name  localhost;
      #charset koi8-r;
      #access_log  logs/host.access.log  main;
      location / {
              proxy_pass      http://webservers;
              proxy_set_header  X-Real-IP  $remote_addr;
      }
}
</pre><br />æ³¨ï¼Œupstream æ˜¯å®šä¹‰åœ¨ server{ } ä¹‹å¤–çš„ï¼Œä¸èƒ½å®šä¹‰åœ¨ server{ } å†…éƒ¨ã€‚å®šä¹‰å¥½ upstream ä¹‹åï¼Œç”¨ proxy_pass å¼•ç”¨ä¸€ä¸‹å³å¯ã€‚<br /><br />max_failsï¼Œå…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1ã€‚å½“è¶…è¿‡æœ€å¤§æ¬¡æ•°æ—¶ï¼Œè¿”å›proxy_next_upstream æ¨¡å—å®šä¹‰çš„é”™è¯¯ã€‚<br />fail_timeoutï¼Œåœ¨ç»å†äº†max_failsæ¬¡å¤±è´¥åï¼Œæš‚åœæœåŠ¡çš„æ—¶é—´ã€‚max_failså¯ä»¥å’Œfail_timeoutä¸€èµ·ä½¿ç”¨ï¼Œè¿›è¡Œå¥åº·çŠ¶æ€æ£€æŸ¥ã€‚<br /><br /><pre name="code" class="java">
upstream webservers {
        server 192.168.18.201 weight=1 max_fails=2 fail_timeout=2;
        server 192.168.18.202 weight=1 max_fails=2 fail_timeout=2;
    }
</pre><br /><br />
  </div>

  

  <ins data-revive-zoneid="171" data-revive-id="8c38e720de1c90a6f6ff52f3f89c4d57"></ins>

  <div id="bottoms" class="clearfix">
    
    <div id="share_weibo">åˆ†äº«åˆ°ï¼š
      <a data-type='sina' href="javascript:;" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"><img src="/images/sina.jpg"></a>
      <a data-type='qq' href="javascript:;" title="åˆ†äº«åˆ°è…¾è®¯å¾®åš"><img src="/images/tec.jpg"></a>
    </div>
  </div>

  <div class="blog_nav">
    <div class="pre_next">
      <a href="/blog/2262599" class="next" title="OpenRestyæœ€ä½³å®è·µ">OpenRestyæœ€ä½³å®è·µ</a>
      |
      <a href="/blog/2261181" class="pre" title="gradle æ–‡ä»¶">gradle æ–‡ä»¶</a>
    </div>
  </div>
  <div class="blog_bottom">
    <ul>
      <li>2015-12-04 17:16</li>
      <li>æµè§ˆ 131</li>
      <li><a href="#comments">è¯„è®º(0)</a></li>
      
      
      <li>åˆ†ç±»:<a href="http://www.iteye.com/blogs/category/mobile">ç§»åŠ¨å¼€å‘</a></li>      
      <li class='last'><a href="http://www.iteye.com/wiki/blog/2261773" target="_blank" class="more">ç›¸å…³æ¨è</a></li>
    </ul>    
  </div>
  
		    
		
<div class="boutique-curr-box blog_comment">
	  <div class="boutique-curr clearfix">
	    <h5 class="h3titles">å‚è€ƒçŸ¥è¯†åº“</h5>
	    
	    <dl class="dlnewlist">
	    
          <dd><a target="_blank" href="http://lib.csdn.net/base/36"><img src="http://img.knowledge.csdn.net/upload/base/1463455906707_707.jpg" width="58" height="58" alt=""></a></dd>
          <dt>
              <a target="_blank" href="http://lib.csdn.net/base/36" classs="title">PHPçŸ¥è¯†åº“</a>
              <span>
                 <em>328</em>&nbsp;&nbsp;å…³æ³¨ <i>|</i> <em>289</em>&nbsp;&nbsp;æ”¶å½•                  
              </span>
          </dt>
      
	    </dl>
	    
	    <dl class="dlnewlist">
	    
          <dd><a target="_blank" href="http://lib.csdn.net/base/40"><img src="http://img.knowledge.csdn.net/upload/base/1463378338830_830.jpg" width="58" height="58" alt=""></a></dd>
          <dt>
              <a target="_blank" href="http://lib.csdn.net/base/40" classs="title">ä¿¡æ¯æ— éšœç¢çŸ¥è¯†åº“</a>
              <span>
                 <em>48</em>&nbsp;&nbsp;å…³æ³¨ <i>|</i> <em>57</em>&nbsp;&nbsp;æ”¶å½•                  
              </span>
          </dt>
      
	    </dl>
	    
	    <dl class="dlnewlist">
	    
          <dd><a target="_blank" href="http://lib.csdn.net/base/37"><img src="http://img.knowledge.csdn.net/upload/base/1463023002983_983.jpg" width="58" height="58" alt=""></a></dd>
          <dt>
              <a target="_blank" href="http://lib.csdn.net/base/37" classs="title">è®¡ç®—æœºç½‘ç»œçŸ¥è¯†åº“</a>
              <span>
                 <em>444</em>&nbsp;&nbsp;å…³æ³¨ <i>|</i> <em>2544</em>&nbsp;&nbsp;æ”¶å½•                  
              </span>
          </dt>
      
	    </dl>
	    
	    <dl class="dlnewlist">
	    
          <dd><a target="_blank" href="http://lib.csdn.net/base/25"><img src="http://img.knowledge.csdn.net/upload/base/1462342584443_443.jpg" width="58" height="58" alt=""></a></dd>
          <dt>
              <a target="_blank" href="http://lib.csdn.net/base/25" classs="title">C#çŸ¥è¯†åº“</a>
              <span>
                 <em>501</em>&nbsp;&nbsp;å…³æ³¨ <i>|</i> <em>312</em>&nbsp;&nbsp;æ”¶å½•                  
              </span>
          </dt>
      
	    </dl>
	    
	  </div>
</div>
 		
      
  <div class="blog_comment">
    <h5>è¯„è®º</h5>
    <a id="comments" name="comments"></a>
    
    
    
  </div>

  <div class="blog_comment">
    <h5>å‘è¡¨è¯„è®º</h5>
            <p style="text-align:center; margin-top:30px;margin-bottom:0px;"><a href="/login" style="background-color:white;"> <img src="/images/login_icon.png" style="vertical-align:middle; margin-right: 10px;" /></a><a href="/login">  æ‚¨è¿˜æ²¡æœ‰ç™»å½•,è¯·æ‚¨ç™»å½•åå†å‘è¡¨è¯„è®º </a></p>
      </div>
</div>


<script type="text/javascript">
  dp.SyntaxHighlighter.HighlightAll('code', true, true);

  $$('#main .blog_content pre[name=code]').each(function(pre, index){ // blog content
    var post_id = 2261773;
    var location = window.location;
    source_url = location.protocol + "//" + location.host + location.pathname + location.search;
    pre.writeAttribute('codeable_id', post_id);
    pre.writeAttribute('codeable_type', "Blog");
    pre.writeAttribute('source_url', source_url);
    pre.writeAttribute('pre_index', index);
    pre.writeAttribute('title', 'Nginxé…ç½®æ–‡ä»¶nginx.confä¸­æ–‡è¯¦è§£[è½¬]');
  });

  fix_image_size($$('div.blog_content img'), 700);

  function processComment() {
    $$('#main .blog_comment > div').each(function(comment){// comment
      var post_id = comment.id.substr(2);
      $$("#"+comment.id+" pre[name=code]").each(function(pre, index){
        var location = window.location;
        source_url = location.protocol + "//" + location.host + location.pathname + location.search;
        source_url += "#" + comment.id;
        pre.writeAttribute('codeable_id', post_id);
        pre.writeAttribute('codeable_type', "BlogComment");
        pre.writeAttribute('source_url', source_url);
        pre.writeAttribute('pre_index', index);
        pre.writeAttribute('title', 'Nginxé…ç½®æ–‡ä»¶nginx.confä¸­æ–‡è¯¦è§£[è½¬]');
      });
    });
  }

  function quote_comment(id) {
    new Ajax.Request('/editor/quote', {
      parameters: {'id':id, 'type':'BlogComment'},
      onSuccess:function(response){editor.bbcode_editor.textarea.insertAfterSelection(response.responseText);
        Element.scrollTo(editor.bbcode_editor.textarea.element);}
    });
  }

  code_favorites_init();
  processComment();
  new WeiboShare({share_buttons: $('share_weibo'), img_scope: $('blog_content')});
</script>




        </div>

        <div id="local">
          <div class="local_top"></div>
          <div id="blog_owner">
  <div id="blog_owner_logo"><a href='http://wangqiaowqo.iteye.com'><img alt="wangqiaowqoçš„åšå®¢" class="logo" src="http://www.iteye.com/upload/logo/user/175165/089e1dff-a31d-3238-8c47-291ec4f21eb2.jpg?1259725957" title="wangqiaowqoçš„åšå®¢: wangqiaowqo" width="" /></a></div>
  <div id="blog_owner_name">wangqiaowqo</div>
</div>

          <div id="blog_actions">
            <ul>
              <li>æµè§ˆ: 1289893 æ¬¡</li>
              <li>æ€§åˆ«: <img alt="Icon_minigender_1" src="http://www.iteye.com/images/icon_minigender_1.gif?1448702469" title="ç”·" /></li>
              <li>æ¥è‡ª: åŒ—äº¬</li>
              <li><img src='/images/status/offline.gif'/></li>
              
            </ul>
          </div>
          <div id="user_visits" class="clearfix">
            <h5>æœ€è¿‘è®¿å®¢ <span style='font-weight:normal;font-size:12px;padding-left:30px;'><a href="/blog/user_visits">æ›´å¤šè®¿å®¢&gt;&gt;</a></span></h5>
            
              <div class="user_visit">
                <div class="logo"><a href='http://gavin2lee.iteye.com' target='_blank'><img alt="gavin2leeçš„åšå®¢" class="logo" src="http://www.iteye.com/upload/logo/user/1081465/a4ecba0b-6f45-3b4b-9743-a814ebcc0e3a-thumb.jpg?1430101964" title="gavin2leeçš„åšå®¢: " width="48px" /></a></div>
                <div class="left"><a href='http://gavin2lee.iteye.com' target='_blank' title='gavin2lee'>gavin2lee</a></div>
              </div>
            
              <div class="user_visit">
                <div class="logo"><a href='http://san-qilang.iteye.com' target='_blank'><img alt="san_qilangçš„åšå®¢" class="logo" src="http://www.iteye.com/images/user-logo-thumb.gif?1448702469" title="san_qilangçš„åšå®¢: " width="48px" /></a></div>
                <div class="left"><a href='http://san-qilang.iteye.com' target='_blank' title='san_qilang'>san_qilang</a></div>
              </div>
            
              <div class="user_visit">
                <div class="logo"><a href='http://jchenzeke.iteye.com' target='_blank'><img alt="jchenzekeçš„åšå®¢" class="logo" src="http://www.iteye.com/images/user-logo-thumb.gif?1448702469" title="jchenzekeçš„åšå®¢: " width="48px" /></a></div>
                <div class="left"><a href='http://jchenzeke.iteye.com' target='_blank' title='jchenzeke'>jchenzeke</a></div>
              </div>
            
              <div class="user_visit">
                <div class="logo"><a href='http://shuaishuaijlo.iteye.com' target='_blank'><img alt="shuaishuaijloçš„åšå®¢" class="logo" src="http://www.iteye.com/images/user-logo-thumb.gif?1448702469" title="shuaishuaijloçš„åšå®¢: " width="48px" /></a></div>
                <div class="left"><a href='http://shuaishuaijlo.iteye.com' target='_blank' title='shuaishuaijlo'>shuaishuaijlo</a></div>
              </div>
            
          </div>

          

                      <div id="blog_menu">
              <h5>æ–‡ç« åˆ†ç±»</h5>
              <ul>
                <li><a href="/">å…¨éƒ¨åšå®¢ (1190)</a></li>
                
                  <li><a href="/category/46931">Java (166)</a></li>
                
                  <li><a href="/category/46930">Linux (88)</a></li>
                
                  <li><a href="/category/46933">Mysql (63)</a></li>
                
                  <li><a href="/category/234868">maven (15)</a></li>
                
                  <li><a href="/category/234855">Hadoop (15)</a></li>
                
                  <li><a href="/category/46932">è§£å†³æ–¹æ¡ˆ (46)</a></li>
                
                  <li><a href="/category/46934">æŠ›å‡ºå¼‚å¸¸çš„å¿ƒæƒ… (11)</a></li>
                
                  <li><a href="/category/51545">SQL server (20)</a></li>
                
                  <li><a href="/category/82694">Android (12)</a></li>
                
                  <li><a href="/category/98180">é¡¹ç›®ç®¡ç† (3)</a></li>
                
                  <li><a href="/category/98181">äººé™…å…³ç³» (1)</a></li>
                
                  <li><a href="/category/99899">Oracle (1)</a></li>
                
                  <li><a href="/category/234854">pentaho (1)</a></li>
                
                  <li><a href="/category/234856">php (11)</a></li>
                
                  <li><a href="/category/234857">achievo (2)</a></li>
                
                  <li><a href="/category/234859">infobright (7)</a></li>
                
                  <li><a href="/category/234860">Ubuntu (5)</a></li>
                
                  <li><a href="/category/234863">python (17)</a></li>
                
                  <li><a href="/category/234864">nginx (4)</a></li>
                
                  <li><a href="/category/234865">cms (6)</a></li>
                
                  <li><a href="/category/234866">svn (10)</a></li>
                
                  <li><a href="/category/234869">eclipse (6)</a></li>
                
                  <li><a href="/category/234874">CSS (1)</a></li>
                
                  <li><a href="/category/346129">zookeeper (2)</a></li>
                
                  <li><a href="/category/351104">spark (9)</a></li>
                
                  <li><a href="/category/349577">Scala (2)</a></li>
                
                  <li><a href="/category/349603">RPC (4)</a></li>
                
                  <li><a href="/category/350609">Lua (1)</a></li>
                
                  <li><a href="/category/351761">ddshow (3)</a></li>
                
                  <li><a href="/category/351762">gradle (4)</a></li>
                
                  <li><a href="/category/351763">å¤§æ•°æ® (11)</a></li>
                
                  <li><a href="/category/351764">avro (2)</a></li>
                
                  <li><a href="/category/351765">docker (1)</a></li>
                
                  <li><a href="/category/351766">sqoop (2)</a></li>
                
                  <li><a href="/category/351774">Hive (12)</a></li>
                
                  <li><a href="/category/351767">finagle (1)</a></li>
                
                  <li><a href="/category/351768">ProtoBuf (1)</a></li>
                
                  <li><a href="/category/351769">excel (1)</a></li>
                
                  <li><a href="/category/351770">ç½‘ç»œ (13)</a></li>
                
                  <li><a href="/category/351771">idea (4)</a></li>
                
                  <li><a href="/category/351772">kafka (3)</a></li>
                
                  <li><a href="/category/351773">spring (16)</a></li>
                
                  <li><a href="/category/351777">jvm (12)</a></li>
                
                  <li><a href="/category/351778">Curator (1)</a></li>
                
                  <li><a href="/category/351779">æ¦‚å¿µæ¯”è¾ƒ (3)</a></li>
                
                  <li><a href="/category/351780">Rè¯­è¨€ (3)</a></li>
                
                  <li><a href="/category/351781">kettle (5)</a></li>
                
                  <li><a href="/category/351782">git (8)</a></li>
                
                  <li><a href="/category/351783">sonar (3)</a></li>
                
                  <li><a href="/category/351784">netty (4)</a></li>
                
                  <li><a href="/category/351785">wireshark (3)</a></li>
                
                  <li><a href="/category/351786">solr (2)</a></li>
                
                  <li><a href="/category/351787">windows (5)</a></li>
                
                  <li><a href="/category/351788">tomcat (2)</a></li>
                
                  <li><a href="/category/351789">activemq (4)</a></li>
                
                  <li><a href="/category/351791">storm (7)</a></li>
                
                  <li><a href="/category/351790">jmeter (1)</a></li>
                
                  <li><a href="/category/351792">Hbase (13)</a></li>
                
                  <li><a href="/category/352741">æ•°æ®ç»“æ„ (2)</a></li>
                
                  <li><a href="/category/352742">å·¥å…· (1)</a></li>
                
                  <li><a href="/category/352743">lisp (2)</a></li>
                
                  <li><a href="/category/352744">cygwin (1)</a></li>
                
                  <li><a href="/category/352745">redis (8)</a></li>
                
                  <li><a href="/category/353239">thrift (4)</a></li>
                
                  <li><a href="/category/353240">tcpdump (1)</a></li>
                
                  <li><a href="/category/353241">github (1)</a></li>
                
                  <li><a href="/category/355028">Drill (1)</a></li>
                
                  <li><a href="/category/355058">tez (1)</a></li>
                
              </ul>
            </div>
            <div id='month_blogs'>
              <h5>ç¤¾åŒºç‰ˆå—</h5>
              <ul>
                <li><a href="/blog/news">æˆ‘çš„èµ„è®¯</a> (0)</li>
                <li>
                  <a href="/blog/post">æˆ‘çš„è®ºå›</a> (34)
                </li>
                <li><a href="/blog/answered_problems">æˆ‘çš„é—®ç­”</a> (3)</li>
              </ul>
            </div>
            <div id="month_blogs">
              <h5>å­˜æ¡£åˆ†ç±»</h5>
              <ul>
                
                  <li><a href="/blog/monthblog/2016-05">2016-05</a> (7)</li>
                
                  <li><a href="/blog/monthblog/2016-04">2016-04</a> (12)</li>
                
                  <li><a href="/blog/monthblog/2016-03">2016-03</a> (26)</li>
                
                <li><a href="/blog/monthblog_more">æ›´å¤šå­˜æ¡£...</a></li>
              </ul>
            </div>
            
            

            <div id="guest_books">
              <h5>æœ€æ–°è¯„è®º</h5>
              <ul>
                
                <li>
                  <a href='http://springjpa-springmvc.iteye.com' target='_blank' title='springjpa_springmvc'>springjpa_springmvc</a>ï¼š 
                  spring mvc demoæ•™ç¨‹æºä»£ç ä¸‹è½½ï¼Œåœ°å€ï¼šhttp: ...<br />
                  <a href="/blog/1141132#bc2384492">[è½¬]spring 3.0 åº”ç”¨springmvc æ„é€ RESTful URL è¯¦ç»†è®²è§£(ä¸€)</a>
                </li>
                
                <li>
                  <a href='http://kxn308.iteye.com' target='_blank' title='kxn308'>kxn308</a>ï¼š 
                  liuyanginjava å†™é“ä½ å¥½é…·å•Š æ‰“ç¹ä½“ï¼Œä½ æ˜¯é¬¼å­å§ç… ...<br />
                  <a href="/blog/1130545#bc2384413">è§£æ±ºTomcat 6.0çš„This is very likely to create a memory leak.çš„éŒ¯èª¤è¨Šæ¯ </a>
                </li>
                
                <li>
                  <a href='http://xiaocszn.iteye.com' target='_blank' title='xiaocszn'>xiaocszn</a>ï¼š 
                  å¥½æ–‡ç« ï¼Œèµï¼<br />
                  <a href="/blog/1161412#bc2382247">select into outfile access denyé—®é¢˜</a>
                </li>
                
                <li>
                  <a href='http://jayant-xu.iteye.com' target='_blank' title='jayant-xu'>jayant-xu</a>ï¼š 
                  [img][list][*][/list][/img]<br />
                  <a href="/blog/404272#bc2376516">IDEAé›†æˆIntelliJadè‡ªåŠ¨åç¼–è¯‘classæ–‡ä»¶</a>
                </li>
                
                <li>
                  <a href='http://fly-ccy.iteye.com' target='_blank' title='fly_å®‡å…‰åè‰²'>fly_å®‡å…‰åè‰²</a>ï¼š 
                  è¯·é—®åœ¨å“ªé‡Œè®¾ç½®Â  ç»•è¿‡è¿‡æ»¤å™¨é“¾ å‘¢ ï¼Ÿ<br />
                  <a href="/blog/1139408#bc2368653">DelegatingFilterProxyã€è½¬ã€‘</a>
                </li>
                
              </ul>
            </div>

            <div class="local_bottom"></div>
          
        </div>
      </div>

      <div id="footer" class="clearfix">
        <div id="copyright">
          <hr/>
          å£°æ˜ï¼šITeyeæ–‡ç« ç‰ˆæƒå±äºä½œè€…ï¼Œå—æ³•å¾‹ä¿æŠ¤ã€‚æ²¡æœ‰ä½œè€…ä¹¦é¢è®¸å¯ä¸å¾—è½¬è½½ã€‚è‹¥ä½œè€…åŒæ„è½¬è½½ï¼Œå¿…é¡»ä»¥è¶…é“¾æ¥å½¢å¼æ ‡æ˜æ–‡ç« åŸå§‹å‡ºå¤„å’Œä½œè€…ã€‚<br />
          &copy; 2003-2016 ITeye.com.   All rights reserved.  [ äº¬ICPè¯110151å·  äº¬å…¬ç½‘å®‰å¤‡110105010620 ]
        </div>
      </div>
    </div>
    <script type="text/javascript">
  document.write("<img src='http://stat.iteye.com/?url="+ encodeURIComponent(document.location.href) + "&referrer=" + encodeURIComponent(document.referrer) + "&user_id=' width='0' height='0' />");
</script>

<script src="http://csdnimg.cn/pubfooter/js/tracking.js?version=20130923164150" type="text/javascript"></script>

    
    
    <script language="javascript" type="text/javascript" src="http://ads.csdn.net/js/async_new.js"></script>
<script src="http://c.csdnimg.cn/public/common/libs/jquery/jquery-1.11.1.min.js" type="text/javascript"></script>
<script type="text/javascript">var $csdn_iteye_jq = jQuery.noConflict();// è§£å†³jqä¸prototype.jså‘½åç©ºé—´å†²çªçš„é—®é¢˜</script>
<script src="http://ads.csdn.net/js/tracking.js" type="text/javascript"></script>
    
	    
	    <script src="http://www.iteye.com/javascripts/web-storage-cache.min.js?1461122670" type="text/javascript"></script>
	    <script src="http://www.iteye.com/javascripts/replace.min.js?1462428995" type="text/javascript"></script>
    
    
  </body>
</html>
