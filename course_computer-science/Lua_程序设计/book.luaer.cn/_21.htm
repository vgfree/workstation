<html>

 <head>
<!-- Original URL: http://book.luaer.cn/_21.htm
Date Downloaded: 2016/4/5 19:56:06 !-->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <title>2.4 Strings - Lua程序设计 </title>
   
   <meta name="GENERATOR" content="Macrobject Word-2-CHM" />
   <link rel="stylesheet" href="Word2Chm.css" type="text/css" />
   <link rel="stylesheet" href="default.css" type="text/css" />
 </head>

 <body lang="ZH-CN" link="blue" vlink="purple" style='text-justify-trim:punctuation'><div style="z-index: 9999; position: fixed; width: 100%; border: 0px; padding: 5px; margin: 0px; background-color: transparent;  font-size: 12pt; font-family: sans-serif;" id="web2disk_nag" onclick="javascript: document.getElementById('web2disk_nag').style.display = 'none';">
		<div style="color: #000000; background-color:#F1F1F1; margin-left: auto; margin-right: auto; border-width: 2px; border-style: solid; width: 550px; ">
			<div style="width: 100%; text-align: center; font-weight: bold; border: 0px; margin: 0px; padding: 0px">Hey, where did my words go? (Click to hide)</div>
			<p>In the trial version of Web2Disk every fifth word is blanked out. 
			To copy this site with all the words, please upgrade to the full version and copy this website again.</p>
			<div style="width: 100%; text-align: center; font-weight: bold; border: 0px; margin: 0px; padding: 0px">
				<a href="http://www.inspyder.com/products/Web2Disk/">Inspyder Web2Disk: The Website Downloader</a>
			</div>
		</div>
	</div>
   <table width="100%" cellpadding="0" cellspacing="0" border="0">
     <tr>
       <td class="moHeader">&nbsp;2.4 Strings </td>
     </tr>
   </table>
  
   <p />

 <div class="Section1" style='layout-grid:15.6pt'>



 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>指字符的序列。 </span><span lang="EN-US">lua </span><span style='font-family:宋体'>是 </span><span lang="EN-US">8 </span><span style='font-family:宋体'>位字节，所以字符串可以包含任何数值字符，包括嵌入的 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>。这意味着你可以存储任意的二进制数据在一个字符串里。 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>中字符串是不可以修改的，你可以创建一个新的变量存放你要的字符串，如下： </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(223,239,226)'><span lang="EN-US">a =  <span style='color:red'>&quot;one string&quot; </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">b = string.gsub(a,  <span style='color:red'>&quot;one&quot; </span>,  <span style='color:red'>&quot;another&quot; </span>)&nbsp;&nbsp;  <span style='color:green'>-- change string parts </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(230,245,242)'><span lang="EN-US">print(a)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; one string </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">print(b)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; another string </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">string </span><span style='font-family:宋体'>和其他对象一样， </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>自动进行内存分配和释放，一个 </span><span lang="EN-US">string </span><span style='font-family:宋体'>可以只包含一个字母也可以包含一本书， </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>可以高效的处理长字符串， </span><span lang="EN-US">1M </span><span style='font-family:宋体'>的 </span><span lang="EN-US">string </span><span style='font-family:宋体'>在 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>中是很常见的。可以使用单引号或者双引号表示字符串 </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(238,234,224);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">a =  <span style='color:red'>&quot;a line&quot; </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(247,240,221)'><span lang="EN-US">b =  <span style='color:red'>'another line' </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>为了风格统一，最好使用一种，除非两种引号嵌套情况。对于字符串中含有引号的情况还可以使用转义符 </span><span lang="EN-US">\ </span><span style='font-family:宋体'>来表示。 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>中的转义序列有： </span></p>

 <div style='border:dashed windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(223,231,251)'><span lang="EN-US">\a bell </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">\b back space &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>后退 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(231,249,223)'><span lang="EN-US">\f form feed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>换页 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">\n newline&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>换行 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(232,248,221)'><span lang="EN-US">\r carriage return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>回车 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">\t horizontal tab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>制表 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(236,237,242)'><span lang="EN-US">\v vertical tab </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">\\ backslash &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;  <span style='color:green'>-- &quot;\&quot; </span></span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(254,228,228)'><span lang="EN-US">\&quot; double quote&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>双引号 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">\' single quote&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>单引号 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(232,230,248)'><span lang="EN-US">\[ left square bracket &nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--  </span></span><span style='font-family:宋体;color:green'>左中括号 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">\] right square bracket &nbsp;&nbsp;&nbsp;  <span style='color:green'>--
 </span></span><span style='font-family:宋体;color:green'>右中括号 </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>例子： </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(222,222,229);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&gt; print( <span style='color:red'>&quot;one line\nnext
line\n\&quot;in quotes\&quot;, 'in ______'&____; </span>) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(254,255,234)'><span lang="EN-US">one line </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">next line </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(241,223,235)'><span lang="EN-US">&quot;in quotes&quot;, 'in quotes' </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&gt; print( <span style='color:red'>'a backslash inside quotes:
\'\\\'' </span>) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(235,238,221)'><span lang="EN-US">a backslash inside quotes: '\' </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&gt; print( <span style='color:red'>&quot;a simpler way: '\\'&quot; </span>) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(232,246,245)'><span lang="EN-US">a simpler way: '\' </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>还可以在字符串中使用 </span><span lang="EN-US">\ddd </span><span style='font-family:宋体'>（ </span><span lang="EN-US">ddd </span><span style='font-family:宋体'>为三位十进制数字）方式表示字母。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">&quot;alo\n123\&quot;&quot; </span><span style='font-family:宋体'>和 </span><span lang="EN-US">'\97lo\10\04923&quot;' </span><span style='font-family:宋体'>是相同的。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>还可以使用 </span><span lang="EN-US">[[...]] </span><span style='font-family:宋体'>表示字符串。这种形式的字符串可以包含多行也，可以嵌套且不会解释转义序列，如果第一个字符是换行符会被自动忽略掉。这种形式的字符串用来包含一段代码是非常方便的。 </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(224,229,235)'><span lang="EN-US">page = [[ </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&lt;HTML&gt; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(235,227,223)'><span lang="EN-US">&lt;HEAD&gt; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&lt;TITLE&gt;An HTML Page&lt;/TITLE&gt; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(223,233,241)'><span lang="EN-US">&lt;/HEAD&gt; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&lt;BODY&gt; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(231,249,247)'><span lang="EN-US">Lua </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">[[a text between double ________]] </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(226,254,228)'><span lang="EN-US">&lt;/BODY&gt; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&lt;/HTML&gt; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(232,230,234)'><span lang="EN-US">]] </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&nbsp; </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(233,230,247)'><span lang="EN-US">io.write(page) </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>运行时， </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>会自动在 </span><span lang="EN-US">string </span><span style='font-family:宋体'>和 </span><span lang="EN-US">numbers </span><span style='font-family:宋体'>之间自动进行类型转换，当一个字符串使用算术操作符时， </span><span lang="EN-US">string </span><span style='font-family:宋体'>就会被转成数字。 </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(243,251,233)'><span lang="EN-US">print( <span style='color:red'>&quot;10&quot; </span> + 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; 11 </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">print( <span style='color:red'>&quot;10 + 1&quot; </span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; 10 + 1 </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(254,227,249)'><span lang="EN-US">print( <span style='color:red'>&quot;-5.3e - 10&quot;  </span>*  <span style='color:red'>&quot;2&quot; </span>)&nbsp;&nbsp;  <span style='color:green'>--&gt;
-1.06e-09 </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">print( <span style='color:red'>&quot;hello&quot; </span> + 1)&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>-- ERROR (cannot convert &____;_____&____;) </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>反过来，当 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>期望一个 </span><span lang="EN-US">string </span><span style='font-family:宋体'>而碰到数字时，会将数字转成 </span><span lang="EN-US">string </span><span style='font-family:宋体'>。 </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(247,244,220);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">print(10 .. 20)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&gt; 1020 </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">.. </span><span style='font-family:宋体'>在 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>中是字符串连接符，当在一个数字后面写 </span><span lang="EN-US">.. </span><span style='font-family:宋体'>时，必须加上空格以防止被解释错。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>尽管字符串和数字可以自动转换，但两者是不同的，像 </span><span lang="EN-US">10 == &quot;10&quot; </span><span style='font-family:宋体'>这样的比较永远都是错的。如果需要显式将 </span><span lang="EN-US">string </span><span style='font-family:宋体'>转成数字可以使用函数 </span><span lang="EN-US">tonumber() </span><span style='font-family:宋体'>，如果 </span><span lang="EN-US">string </span><span style='font-family:宋体'>不是正确的数字该函数将返回 </span><span lang="EN-US">nil </span><span style='font-family:宋体'>。 </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(249,226,231);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">line = io.read()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>-- read a line </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(238,253,252)'><span lang="EN-US">n = tonumber(line)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>-- try to convert __ to a number </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US" style='color:blue'>if </span><span lang="EN-US"> n ==  <span style='color:blue'>nil </span>  <span style='color:blue'>then </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(244,245,247)'><span lang="EN-US">&nbsp;&nbsp;&nbsp; error(line ..  <span style='color:red'>&quot; is
not a valid ______&____; </span>) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US" style='color:blue'>else </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(240,225,222)'><span lang="EN-US">&nbsp;&nbsp;&nbsp; print(n*2) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US" style='color:blue'>end </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>反之 </span><span lang="EN-US">, </span><span style='font-family:宋体'>可以调用 </span><span lang="EN-US">tostring() </span><span style='font-family:宋体'>将数字转成字符串，这种转换一直有效： </span></p>

 <div style='border:RGB(171,163,36) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(235,236,238);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">print(tostring(10) ==  <span style='color:red'>&quot;10&quot; </span>)&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; true </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(239,237,229)'><span lang="EN-US">print(10 ..  <span style='color:red'>&quot;&quot; </span> ==  <span style='color:red'>&quot;10&quot; </span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; true </span></span></p>

 </div>


 </div>
   <p />
   <hr class="moHR" />
   <span class="moCopyright">
    ____：
 <br /><a href="_3.htm">lua程序设计目录 </a> -  <a href="http://www.luaer.cn">中国lua开发者 </a> -  <a href="http://bbs.luaer.cn">lua论坛 </a> 
   </span><div id="bookfoot"></div>
 <script language="JavaScript" src="js/ad.js"></script>
 </body>

 </html>

 