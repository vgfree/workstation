<html>

 <head>
<!-- Original URL: http://book.luaer.cn/_114.htm
Date Downloaded: 2016/4/5 19:56:12 !-->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <title>20.2 模式 - Lua程序设计 </title>
   
   <meta name="GENERATOR" content="Macrobject Word-2-CHM" />
   <link rel="stylesheet" href="Word2Chm.css" type="text/css" />
   <link rel="stylesheet" href="default.css" type="text/css" />
 </head>

 <body lang="ZH-CN" link="blue" vlink="purple" style='text-justify-trim:punctuation'><div style="z-index: 9999; position: fixed; width: 100%; border: 0px; padding: 5px; margin: 0px; background-color: transparent;  font-size: 12pt; font-family: sans-serif;" id="web2disk_nag" onclick="javascript: document.getElementById('web2disk_nag').style.display = 'none';">
		<div style="color: #000000; background-color:#F1F1F1; margin-left: auto; margin-right: auto; border-width: 2px; border-style: solid; width: 550px; ">
			<div style="width: 100%; text-align: center; font-weight: bold; border: 0px; margin: 0px; padding: 0px">Hey, where did my words go? (Click to hide)</div>
			<p>In the trial version of Web2Disk every fifth word is blanked out. 
			To copy this site with all the words, please upgrade to the full version and copy this website again.</p>
			<div style="width: 100%; text-align: center; font-weight: bold; border: 0px; margin: 0px; padding: 0px">
				<a href="http://www.inspyder.com/products/Web2Disk/">Inspyder Web2Disk: The Website Downloader</a>
			</div>
		</div>
	</div>
   <table width="100%" cellpadding="0" cellspacing="0" border="0">
     <tr>
       <td class="moHeader">&nbsp;20.2 模式 </td>
     </tr>
   </table>
  
   <p />

 <div class="Section1" style='layout-grid:15.6pt'>



 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>你还可以在模式串中使用字符类。字符类指可以匹配一个特定字符集合内任何字符的模式项。比如，字符类 </span><span lang="EN-US">%d </span><span style='font-family:宋体'>匹配任意数字。所以你可以使用模式串 </span><span lang="EN-US">'%d%d/%d%d/%d%d%d%d' </span><span style='font-family:宋体'>搜索 </span><span lang="EN-US">dd/mm/yyyy </span><span style='font-family:宋体'>格式的日期： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(247,220,250)'><span lang="EN-US">s =  <span style='color:red'>&quot;Deadline is 30/05/1999, firm&quot; </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">date =  <span style='color:red'>&quot;%d%d/%d%d/%d%d%d%d&quot; </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(224,236,250)'><span lang="EN-US">print(string.sub(s, string.find(s, date)))&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; 30/05/1999 </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>下面的表列出了 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>支持的所有字符类： </span></p>

 <div style='border:dashed windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(223,243,225)'><span lang="EN-US">.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:
宋体'>任意字符 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">%a&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>字母 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(220,241,222)'><span lang="EN-US">%c&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>控制字符 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">%d&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>数字 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(245,237,253)'><span lang="EN-US">%l&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>小写字母 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">%p&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>标点字符 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(223,237,247)'><span lang="EN-US">%s&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>空白符 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">%u&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>大写字母 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(228,254,231)'><span lang="EN-US">%w&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>字母和数字 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">%x&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>十六进制数字 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(247,221,233)'><span lang="EN-US">%z&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:宋体'>代表 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>的字符 </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>上面字符类的大写形式表示小写所代表的集合的补集。例如， </span><span lang="EN-US">'%A' </span><span style='font-family:宋体'>非字母的字符： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(239,255,238)'><span lang="EN-US">print(string.gsub( <span style='color:red'>&quot;hello,
up-down!&quot; </span>,  <span style='color:red'>&quot;%A&quot; </span>,  <span style='color:red'>&quot;.&quot; </span>)) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; hello..up.down.
4 </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>（数字 </span><span lang="EN-US">4 </span><span style='font-family:宋体'>不是字符串结果的一部分，他是 </span><span lang="EN-US">gsub </span><span style='font-family:宋体'>返回的第二个结果，代表发生替换的次数。下面其他的关于打印 </span><span lang="EN-US">gsub </span><span style='font-family:宋体'>结果的例子中将会忽略这个数值。）在模式匹配中有一些特殊字符，他们有特殊的意义， </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>中的特殊字符如下： </span></p>

 <div style='border:dashed windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(239,220,234);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">( ) . % + - * ? [ ^ $ </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">'%'  </span><span style='font-family:宋体'>用作特殊字符的转义字符，因此 </span>  <span lang="EN-US">'%.'  </span><span style='font-family:宋体'>匹配点； </span><span lang="EN-US">'%%'  </span><span style='font-family:宋体'>匹配字符 </span>  <span lang="EN-US">'%' </span><span style='font-family:宋体'>。转义字符 </span>  <span lang="EN-US">'%' </span><span style='font-family:宋体'>不仅可以用来转义特殊字符，还可以用于所有的非字母的字符。当对一个字符有疑问的时候，为安全起见请使用转义字符转义他。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>对 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>而言，模式串就是普通的字符串。他们和其他的字符串没有区别，也不会受到特殊对待。只有他们被用作模式串用于函数的时候， </span><span lang="EN-US">'%'  </span><span style='font-family:宋体'>才作为转义字符。所以，如果你需要在一个模式串内放置引号的话，你必须使用在其他的字符串中放置引号的方法来处理，使用 </span>
 <span lang="EN-US">'\'  </span><span style='font-family:宋体'>转义引号， </span><span lang="EN-US">'\'  </span><span style='font-family:宋体'>是 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>的转义符。你可以使用方括号将字符类或者字符括起来创建自己的字符类（译者： </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>称之为 </span><span lang="EN-US">char-set </span><span style='font-family:宋体'>，就是指传统正则表达式概念中的括号表达式）。比如， </span><span lang="EN-US">'[%w_]'
 </span><span style='font-family:宋体'>将匹配字母数字和下划线， </span><span lang="EN-US">'[01]'  </span><span style='font-family:宋体'>匹配二进制数字， </span><span lang="EN-US">'[%[%]]'  </span><span style='font-family:宋体'>匹配一对方括号。下面的例子统计文本中元音字母出现的次数： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(226,227,221);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">_, nvow = string.gsub(text, &____;[__________]&____;, &quot;&quot;) </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>在 </span><span lang="EN-US">char-set </span><span style='font-family:宋体'>中可以使用范围表示字符的集合，第一个字符和最后一个字符之间用连字符连接表示这两个字符之间范围内的字符集合。大部分的常用字符范围都已经预定义好了，所以一般你不需要自己定义字符的集合。比如， </span><span lang="EN-US">'%d'  </span><span style='font-family:宋体'>表示 </span><span lang="EN-US">
'[0-9]' </span><span style='font-family:宋体'>； </span><span lang="EN-US">'%x'  </span><span style='font-family:宋体'>表示 </span><span lang="EN-US"> '[0-9a-fA-F]' </span><span style='font-family:宋体'>。然而，如果你想查找八进制数，你可能更喜欢使用 </span><span lang="EN-US"> '[0-7]'  </span><span style='font-family:宋体'>而不是 </span><span lang="EN-US"> '[01234567]' </span><span style='font-family:宋体'>。你可以在字符集 </span><span lang="EN-US">(char-set) </span><span style='font-family:宋体'>的开始处使用 </span>  <span lang="EN-US">'^'  </span><span style='font-family:宋体'>表示其补集： </span><span lang="EN-US">'[^0-7]'  </span><span style='font-family:宋体'>匹配任何不是八进制数字的字符； </span><span lang="EN-US">'[^\n]'  </span><span style='font-family:宋体'>匹配任何非换行符户的字符。记住，可以使用大写的字符类表示其补集： </span><span lang="EN-US">'%S'
 </span><span style='font-family:宋体'>比 </span><span lang="EN-US"> '[^%s]'  </span><span style='font-family:宋体'>要简短些。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">Lua </span><span style='font-family:宋体'>的字符类依赖于本地环境，所以 </span><span lang="EN-US"> '[a-z]'  </span><span style='font-family:宋体'>可能与 </span><span lang="EN-US"> '%l'  </span><span style='font-family:宋体'>表示的字符集不同。在一般情况下，后者包括 </span>  <span lang="EN-US">'&ccedil;'  </span><span style='font-family:宋体'>和 </span>  <span lang="EN-US">'&atilde;' </span><span style='font-family:宋体'>，而前者没有。应该尽可能的使用后者来表示字母，除非出于某些特殊考虑，因为后者更简单、方便、更高效。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>可以使用修饰符来修饰模式增强模式的表达能力， </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>中的模式修饰符有四个： </span></p>

 <div style='border:dashed windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(237,226,239);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:
宋体'>匹配前一字符 </span><span lang="EN-US">1 </span><span style='font-family:宋体'>次或多次 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(239,226,223)'><span lang="EN-US">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:
宋体'>匹配前一字符 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>次或多次 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:
宋体'>匹配前一字符 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>次或多次 </span></p>

 <p class="AltP" style='margin:0cm;margin-bottom:.0001pt;background:RGB(231,247,254)'><span lang="EN-US">?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span style='font-family:
宋体'>匹配前一字符 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>次或 </span><span lang="EN-US">1 </span><span style='font-family:宋体'>次 </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">'+' </span><span style='font-family:宋体'>，匹配一个或多个字符，总是进行最长的匹配。比如，模式串 </span><span lang="EN-US">
'%a+'  </span><span style='font-family:宋体'>匹配一个或多个字母或者一个单词： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(220,246,243)'><span lang="EN-US">print(string.gsub(&quot;one, and two; and _____&____;,
&____;%_+&____;, &quot;word&quot;)) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&nbsp;&nbsp;&nbsp; --&gt; word, word ____; word word </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">'%d+'  </span><span style='font-family:宋体'>匹配一个或多个数字（整数）： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:RGB(248,239,237);margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">i, j = string.find( <span style='color:red'>&quot;the number 1298 is
even&quot; </span>,  <span style='color:red'>&quot;%d+&quot; </span>) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(236,226,246)'><span lang="EN-US">print(i,j)&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; 12 &nbsp;&nbsp;15 </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">'*'  </span><span style='font-family:宋体'>与 </span>  <span lang="EN-US">'+'  </span><span style='font-family:宋体'>类似，但是他匹配一个字符 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>次或多次出现 </span><span lang="EN-US">. </span><span style='font-family:宋体'>一个典型的应用是匹配空白。比如，为了匹配一对圆括号 </span><span lang="EN-US">() </span><span style='font-family:宋体'>或者括号之间的空白，可以使用 </span><span lang="EN-US"> '%(%s*%)' </span><span style='font-family:宋体'>。（ </span><span lang="EN-US"> '%s*'  </span><span style='font-family:宋体'>用来匹配 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>个或多个空白。由于圆括号在模式中有特殊的含义，所以我们必须使用 </span>  <span lang="EN-US">'%'
 </span><span style='font-family:宋体'>转义他。）再看一个例子， </span><span lang="EN-US">'[_%a][_%w]*'
 </span><span style='font-family:宋体'>匹配 </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>程序中的标示符：字母或者下划线开头的字母下划线数字序列。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">'-'  </span><span style='font-family:宋体'>与 </span>  <span lang="EN-US">'*'  </span><span style='font-family:宋体'>一样，都匹配一个字符的 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>次或多次出现，但是他进行的是最短匹配。某些时候这两个用起来没有区别，但有些时候结果将截然不同。比如，如果你使用模式 </span><span lang="EN-US"> '[_%a][_%w]-'  </span><span style='font-family:宋体'>来查找标示符，你将只能找到第一个字母，因为 </span><span lang="EN-US"> '[_%w]-'  </span><span style='font-family:宋体'>永远匹配空。另一方面，假定你想查找 </span><span lang="EN-US">C </span><span style='font-family:宋体'>程序中的注释，很多人可能使用 </span><span lang="EN-US"> '/%*.*%*/' </span><span style='font-family:宋体'>（也就是说 </span><span lang="EN-US"> &quot;/*&quot;  </span><span style='font-family:宋体'>后面跟着任意多个字符，然后跟着 </span><span lang="EN-US"> &quot;*/&quot;  </span><span style='font-family:宋体'>）。然而，由于 </span><span lang="EN-US"> '.*'  </span><span style='font-family:宋体'>进行的是最长匹配，这个模式将匹配程序中第一个 </span><span lang="EN-US"> &quot;/*&quot;  </span><span style='font-family:宋体'>和最后一个 </span>  <span lang="EN-US">&quot;*/&quot;  </span><span style='font-family:宋体'>之间所有部分： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(250,223,221)'><span lang="EN-US">test =  <span style='color:red'>&quot;int x; /* x */&____; int y; /*
y */&quot; </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">print(string.gsub(test,  <span style='color:red'>&quot;/%*.*%*/&quot; </span>,
 <span style='color:red'>&quot;&lt;COMMENT&gt;&quot; </span>)) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(228,237,250)'><span lang="EN-US">&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; int x;
&lt;COMMENT&gt; </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>然而模式 </span><span lang="EN-US"> '.-'  </span><span style='font-family:宋体'>进行的是最短匹配，她会匹配 </span><span lang="EN-US"> &quot;/*&quot;  </span><span style='font-family:宋体'>开始到第一个 </span><span lang="EN-US"> &quot;*/&quot;  </span><span style='font-family:宋体'>之前的部分： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(251,224,242)'><span lang="EN-US">test =  <span style='color:red'>&quot;int x; /* x */&____; int y; /*
y */&quot; </span></span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">print(string.gsub(test,  <span style='color:red'>&quot;/%*.-%*/&quot; </span>,
 <span style='color:red'>&quot;&lt;COMMENT&gt;&quot; </span>)) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(242,243,255)'><span lang="EN-US">&nbsp;&nbsp;&nbsp;  <span style='color:green'>--&gt; int x;
&lt;COMMENT&gt;&nbsp; int _; &lt;COMMENT&gt; </span></span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">'?'  </span><span style='font-family:宋体'>匹配一个字符 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>次或 </span><span lang="EN-US">1 </span><span style='font-family:宋体'>次。举个例子，假定我们想在一段文本内查找一个整数，整数可能带有正负号。模式 </span><span lang="EN-US"> '[+-]?%d+'  </span><span style='font-family:宋体'>符合我们的要求，它可以匹配像 </span><span lang="EN-US"> &quot;-12&quot; </span><span style='font-family:宋体'>、 </span><span lang="EN-US">&quot;23&quot;  </span><span style='font-family:宋体'>和 </span><span lang="EN-US"> &quot;+1009&quot;  </span><span style='font-family:宋体'>等数字。 </span><span lang="EN-US">'[+-]'  </span><span style='font-family:宋体'>是一个匹配 </span>  <span lang="EN-US">'+'  </span><span style='font-family:宋体'>或者 </span>  <span lang="EN-US">'-'
 </span><span style='font-family:宋体'>的字符类；接下来的 </span>  <span lang="EN-US">'?'  </span><span style='font-family:宋体'>意思是匹配前面的字符类 </span><span lang="EN-US">0 </span><span style='font-family:宋体'>次或者 </span><span lang="EN-US">1 </span><span style='font-family:宋体'>次。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>与其他系统的模式不同的是， </span><span lang="EN-US">Lua </span><span style='font-family:宋体'>中的修饰符不能用字符类；不能将模式分组然后使用修饰符作用这个分组。比如，没有一个模式可以匹配一个可选的单词（除非这个单词只有一个字母）。下面我将看到，通常你可以使用一些高级技术绕开这个限制。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>以 </span>
 <span lang="EN-US">'^'  </span><span style='font-family:宋体'>开头的模式只匹配目标串的开始部分，相似的，以 </span>
 <span lang="EN-US">'$'  </span><span style='font-family:宋体'>结尾的模式只匹配目标串的结尾部分。这不仅可以用来限制你要查找的模式，还可以定位（ </span><span lang="EN-US">anchor </span><span style='font-family:宋体'>）模式。比如： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(220,245,249)'><span lang="EN-US" style='color:blue'>if </span><span lang="EN-US"> string.find(s,  <span style='color:red'>&quot;^%d&quot; </span>)  <span style='color:blue'>then </span>
... </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>检查字符串 </span><span lang="EN-US">s </span><span style='font-family:宋体'>是否以数字开头，而 </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(252,250,255)'><span lang="EN-US" style='color:blue'>if </span><span lang="EN-US"> string.find(s,  <span style='color:red'>&quot;^[+-]?%d+$&quot; </span>)  <span style='color:blue'>then </span>
... </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>检查字符串 </span><span lang="EN-US">s </span><span style='font-family:宋体'>是否是一个整数。 </span></p>

 <p class="MsoNormal" style='text-indent:21.0pt'><span lang="EN-US">'%b'  </span><span style='font-family:宋体'>用来匹配对称的字符。常写为 </span><span lang="EN-US"> '%bxy'  </span><span style='font-family:宋体'>， </span><span lang="EN-US">x </span><span style='font-family:
宋体'>和 </span><span lang="EN-US">y </span><span style='font-family:宋体'>是任意两个不同的字符； </span><span lang="EN-US">x </span><span style='font-family:宋体'>作为匹配的开始， </span><span lang="EN-US">y </span><span style='font-family:宋体'>作为匹配的结束。比如， </span><span lang="EN-US">'%b()'  </span><span style='font-family:宋体'>匹配以 </span>  <span lang="EN-US">'('  </span><span style='font-family:宋体'>开始，以 </span>  <span lang="EN-US">')'  </span><span style='font-family:宋体'>结束的字符串： </span></p>

 <div style='border:RGB(11,197,62) dashed 1px;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#fff;margin-left:21.0pt;margin-right:21.0pt'>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(233,237,251)'><span lang="EN-US">print(string.gsub( <span style='color:red'>&quot;a (enclosed (in)
parentheses) line&quot; </span>, </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:#fff'><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span style='color:red'>&quot;%b()&quot; </span>,  <span style='color:red'>&quot;&quot; </span>)) </span></p>

 <p class="AltD" style='margin:0cm;margin-bottom:.0001pt;background:RGB(248,247,249)'><span lang="EN-US" style='color:green'>--&gt; a&nbsp; line </span></p>

 </div>

 <p class="MsoNormal" style='text-indent:21.0pt'><span style='font-family:宋体'>常用的这种模式有： </span><span lang="EN-US">'%b()'  </span><span style='font-family:宋体'>， </span><span lang="EN-US">'%b[]' </span><span style='font-family:宋体'>， </span><span lang="EN-US">'%b%{%}'  </span><span style='font-family:宋体'>和 </span><span lang="EN-US"> '%b&lt;&gt;' </span><span style='font-family:宋体'>。你也可以使用任何字符作为分隔符。 </span></p>


 </div>
   <p />
   <hr class="moHR" />
   <span class="moCopyright">
    ____：
 <br /><a href="_3.htm">lua程序设计目录 </a> -  <a href="http://www.luaer.cn">中国lua开发者 </a> -  <a href="http://bbs.luaer.cn">lua论坛 </a> 
   </span><div id="bookfoot"></div>
 <script language="JavaScript" src="js/ad.js"></script>
 </body>

 </html>

 